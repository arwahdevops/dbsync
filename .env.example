# .env.example - Example Configuration for dbsync
# ================================================
# Please adjust these values according to your environment.
# DO NOT COMMIT THIS FILE WITH REAL PASSWORDS TO GIT!

# --- Main Synchronization Settings ---
# Synchronization direction (required): mysql-to-postgres, postgres-to-mysql, etc.
SYNC_DIRECTION=mysql-to-postgres

# Batch size for data transfer
BATCH_SIZE=1000

# Number of worker goroutines to process tables in parallel
WORKERS=8

# Maximum timeout for synchronizing a single table (schema + data)
# Format: 10s, 5m, 1h
TABLE_TIMEOUT=10m

# Schema synchronization strategy: drop_create, alter, none
# 'alter' is still experimental and might be incomplete. 'drop_create' will delete the destination table!
SCHEMA_SYNC_STRATEGY=drop_create

# If true, continue to the next table if one table fails (schema or data)
SKIP_FAILED_TABLES=false

# (EXPERIMENTAL) Try to disable FK constraints in the destination during data load? (MySQL/Postgres)
# Might not be necessary if constraints are created after data load.
DISABLE_FK_DURING_SYNC=false


# --- Retry Settings ---
# Maximum number of retries for transient errors (e.g., failed batch insert)
MAX_RETRIES=3

# Time interval between retries
# Format: 5s, 1m
RETRY_INTERVAL=5s


# --- Database Connection Pool Settings ---
# Maximum number of open connections in the pool
CONN_POOL_SIZE=20

# Maximum connection lifetime before closing and reopening
# Format: 30m, 1h
CONN_MAX_LIFETIME=1h


# --- Source Database Settings (SRC) ---
# Change these values according to your source database
SRC_DIALECT=mysql        # Dialect: mysql, postgres, sqlite
SRC_HOST=127.0.0.1
SRC_PORT=3306
SRC_USER=source_user
SRC_PASSWORD=source_secret_password # CHANGE TO REAL PASSWORD (CAREFUL!)
SRC_DBNAME=source_db
SRC_SSLMODE=disable      # Options: disable, require, verify-ca, verify-full (depends on DB & setup)


# --- Destination Database Settings (DST) ---
# Change these values according to your destination database
DST_DIALECT=postgres     # Dialect: mysql, postgres
DST_HOST=127.0.0.1
DST_PORT=5432
DST_USER=destination_user
DST_PASSWORD=destination_secret_password # CHANGE TO REAL PASSWORD (CAREFUL!)
DST_DBNAME=destination_db
DST_SSLMODE=disable      # Options: disable, require, verify-ca, verify-full


# --- Observability & Debugging Settings ---
# Debug Mode (more logs, stack traces, etc.)
DEBUG_MODE=true

# Format log output as JSON (useful for log collectors)
ENABLE_JSON_LOGGING=false

# Enable pprof endpoints for profiling (at /debug/pprof/)
# CAUTION: Do not expose these endpoints publicly in production without authentication!
ENABLE_PPROF=false

# Port for the HTTP server serving /metrics, /healthz, /readyz, and pprof
METRICS_PORT=9091

# --- Other Configuration Examples ---

# Example for SQLite -> PostgreSQL
# SYNC_DIRECTION=sqlite-to-postgres
# SRC_DIALECT=sqlite
# SRC_DBNAME=/path/to/your/database.db # File path for SQLite
# SRC_HOST= N/A (not used by SQLite)
# SRC_PORT= N/A
# SRC_USER= N/A
# SRC_PASSWORD= N/A
# SRC_SSLMODE=disable
# DST_DIALECT=postgres
# DST_HOST=localhost
# DST_PORT=5432
# DST_USER=pguser
# DST_PASSWORD=pgpass
# DST_DBNAME=pgdb
# DST_SSLMODE=disable

# Example for PostgreSQL -> MySQL
# SYNC_DIRECTION=postgres-to-mysql
# SRC_DIALECT=postgres
# SRC_HOST=localhost
# SRC_PORT=5432
# SRC_USER=pguser
# SRC_PASSWORD=pgpass
# SRC_DBNAME=pgdb
# SRC_SSLMODE=disable
# DST_DIALECT=mysql
# DST_HOST=localhost
# DST_PORT=3306
# DST_USER=mysqluser
# DST_PASSWORD=mysqlpass
# DST_DBNAME=mysqldb
# DST_SSLMODE=disable
